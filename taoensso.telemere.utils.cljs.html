<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>taoensso.telemere.utils documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Telemere</span> <span class="project-version">1.0.0-beta9</span></span></a></h1><div id="langs"><div class="lang"><a href="index.clj.html">clj</a></div><div class="lang current">cljs</div></div></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>taoensso</span></div></div></li><li class="depth-2"><a href="taoensso.telemere.cljs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>telemere</span></div></a></li><li class="depth-3 branch"><a href="taoensso.telemere.timbre.cljs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>timbre</span></div></a></li><li class="depth-3 current"><a href="taoensso.telemere.utils.cljs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-error-in-signal-.3Emaps"><div class="inner"><span>error-in-signal-&gt;maps</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-error-signal.3F"><div class="inner"><span>error-signal?</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-format-error-fn"><div class="inner"><span>format-error-fn</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-format-inst-fn"><div class="inner"><span>format-inst-fn</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-format-nsecs-fn"><div class="inner"><span>format-nsecs-fn</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-format-signal-fn"><div class="inner"><span>format-signal-fn</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-js-console-logger"><div class="inner"><span>js-console-logger</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-minify-signal"><div class="inner"><span>minify-signal</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-newline"><div class="inner"><span>newline</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-pr-edn"><div class="inner"><span>pr-edn</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-pr-json"><div class="inner"><span>pr-json</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-pr-signal-fn"><div class="inner"><span>pr-signal-fn</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-remove-kvs"><div class="inner"><span>remove-kvs</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-signal-content-fn"><div class="inner"><span>signal-content-fn</span></div></a></li><li class="depth-1"><a href="taoensso.telemere.utils.cljs.html#var-signal-preamble-fn"><div class="inner"><span>signal-preamble-fn</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">taoensso.telemere.utils</h1><div class="doc"><pre class="plaintext">Misc utils useful for Telemere handlers, middleware, etc.
</pre></div><div class="public anchor" id="var-error-in-signal-.3Emaps"><h3>error-in-signal-&gt;maps</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-error-in-signal-.3Emaps">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(error-in-signal-&gt;maps signal)</code></div><div class="doc"><pre class="plaintext">Experimental, subject to change.
Returns given signal with possible `:error` replaced by
[{:keys [type msg data]} ...] cause chain.

Useful when serializing signals to edn/JSON/etc.</pre></div></div><div class="public anchor" id="var-error-signal.3F"><h3>error-signal?</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-error-signal.3F">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(error-signal? signal)</code></div><div class="doc"><pre class="plaintext">Experimental, subject to change.
Returns true iff given signal has an `:error` value, or a `:kind` or `:level`
that indicates that it's an error.</pre></div></div><div class="public anchor" id="var-format-error-fn"><h3>format-error-fn</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-format-error-fn">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(format-error-fn)</code><code>(format-error-fn {:as _opts})</code></div><div class="doc"><pre class="plaintext">Experimental, subject to change.
Returns a (fn format [error]) that:
  - Takes a platform error (`Throwable` or `js/Error`).
  - Returns a human-readable error string.</pre></div></div><div class="public anchor" id="var-format-inst-fn"><h3>format-inst-fn</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-format-inst-fn">clj</a></h4><h4 class="lang current">cljs</h4><h4 class="added">added in Encore v3.98.0 (2024-04-08)</h4><div class="usage"><code>(format-inst-fn)</code><code>(format-inst-fn {:keys [formatter]})</code></div><div class="doc"><pre class="plaintext">Experimental, subject to change without notice.

Returns a (fn format [instant]) that:
  - Takes a platform instant (`java.time.Instant` or `js/Date`).
  - Returns a formatted human-readable instant string.

Options:
  `:zone` (Clj only) `java.time.ZoneOffset` (defaults to UTC).
  `:formatter`
    `java.time.format.DateTimeFormatter` (Clj) or
    `goog.i18n.DateTimeFormat` (Cljs),

    Defaults to `ISO8601` formatter (`YYYY-MM-DDTHH:mm:ss.sssZ`),
    e.g.: "2011-12-03T10:15:130Z".</pre></div></div><div class="public anchor" id="var-format-nsecs-fn"><h3>format-nsecs-fn</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-format-nsecs-fn">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(format-nsecs-fn)</code><code>(format-nsecs-fn {:as _opts})</code></div><div class="doc"><pre class="plaintext">Experimental, subject to change.
Returns a (fn format [nanosecs]) that:
  - Takes a long nanoseconds (e.g. runtime).
  - Returns a human-readable string like:
    "1.00m", "4.20s", "340ms", "822μs", etc.</pre></div></div><div class="public anchor" id="var-format-signal-fn"><h3>format-signal-fn</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-format-signal-fn">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(format-signal-fn)</code><code>(format-signal-fn {:keys [incl-newline? preamble-fn content-fn], :or {incl-newline? true, preamble-fn (signal-preamble-fn), content-fn (signal-content-fn)}})</code></div><div class="doc"><pre class="plaintext">Experimental, subject to change.
Returns a (fn format [signal]) that:
  - Takes a Telemere signal (map).
  - Returns a human-readable signal string.

Options:
  `:incl-newline?` - Include terminating system newline? (default true)
  `:preamble-fn`   - (fn [signal]) =&gt; signal preamble string.
  `:content-fn`    - (fn [signal]) =&gt; signal content  string.

See also `pr-signal-fn` for machine-readable output.</pre></div></div><div class="public anchor" id="var-js-console-logger"><h3>js-console-logger</h3><h4 class="lang current">cljs</h4><div class="usage"><code>(js-console-logger level)</code></div><div class="doc"><pre class="plaintext">Returns JavaScript console logger to match given signal level:
  `:trace` -&gt; `js/console.trace`,
  `:error` -&gt; `js/console.error`, etc.

Defaults to `js.console.log` for unmatched signal levels.
NB: assumes that `js/console` exists, handler constructors should check first!</pre></div></div><div class="public anchor" id="var-minify-signal"><h3>minify-signal</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-minify-signal">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(minify-signal signal)</code></div><div class="doc"><pre class="plaintext">Experimental, subject to change.
Returns minimal signal, removing:
  - Keys with nil values, and
  - Keys with redundant values (`:kvs`, `:location`, `:file`).

Useful when serializing signals to edn/JSON/etc.</pre></div></div><div class="public anchor" id="var-newline"><h3>newline</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-newline">clj</a></h4><h4 class="lang current">cljs</h4><h4 class="added">added in Encore v3.68.0 (2023-09-25)</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Single system newline
</pre></div></div><div class="public anchor" id="var-pr-edn"><h3>pr-edn</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-pr-edn">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(pr-edn x)</code></div><div class="doc"><pre class="plaintext">Prints given arg to an edn string readable with `read-edn`.
</pre></div></div><div class="public anchor" id="var-pr-json"><h3>pr-json</h3><h4 class="lang current">cljs</h4><h4 class="added">added in Encore v3.98.0 (2024-04-08)</h4><div class="usage"><code>(pr-json x)</code></div><div class="doc"><pre class="plaintext">Returns given Cljs argument as JSON string.
</pre></div></div><div class="public anchor" id="var-pr-signal-fn"><h3>pr-signal-fn</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-pr-signal-fn">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(pr-signal-fn pr-fn)</code><code>(pr-signal-fn pr-fn {:keys [incl-thread? incl-kvs? incl-newline? prep-fn], :or {incl-newline? true, prep-fn (comp error-in-signal-&gt;maps minify-signal)}})</code></div><div class="doc"><pre class="plaintext">Experimental, subject to change.
Returns a (fn pr [signal]) that:
  - Takes a Telemere signal (map).
  - Returns a machine-readable (minified) signal string.

Options:
  `pr-fn`          - ∈ #{&lt;unary-fn&gt; :edn :json (Cljs only)}
  `:incl-thread?`  - Include signal `:thread` info?      (default false)
  `:incl-kvs?`     - Include signal `:kvs`    info?      (default false)
  `:incl-newline?` - Include terminating system newline? (default true)

Examples:
  (pr-signal-fn :edn  {&lt;opts&gt;})
  (pr-signal-fn :json {&lt;opts&gt;}) ; Cljs only

  ;; To output JSON for Clj, you must provide an appropriate `pr-fn`.
  ;; `jsonista` is a good option, Ref. &lt;<a href="https://github.com/metosin/jsonista">https://github.com/metosin/jsonista</a>&gt;:
    (require '[jsonista.core :as jsonista])
    (pr-signal-fn jsonista/write-value-as-string {&lt;opts&gt;})

See also `format-signal-fn` for human-readable output.</pre></div></div><div class="public anchor" id="var-remove-kvs"><h3>remove-kvs</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-remove-kvs">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(remove-kvs signal)</code></div><div class="doc"><pre class="plaintext">Returns given signal without user-level kvs.
</pre></div></div><div class="public anchor" id="var-signal-content-fn"><h3>signal-content-fn</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-signal-content-fn">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(signal-content-fn)</code><code>(signal-content-fn {:keys [incl-thread? incl-kvs? raw-error? format-nsecs-fn format-error-fn], :or {format-nsecs-fn (format-nsecs-fn), format-error-fn (format-error-fn)}})</code></div><div class="doc"><pre class="plaintext">Experimental, subject to change.
Returns a (fn content [signal]) that:
  - Takes a Telemere signal (map).
  - Returns a signal content ?string (incl. data, ctx, etc.).

Options:
  `:incl-thread?`    - Include signal `:thread` info? (default false)
  `:incl-kvs?`       - Include signal `:kvs`    info? (default false)
  `:raw-error?`      - Retain unformatted error?      (default false)
  `:format-nsecs-fn` - (fn [nanosecs]) =&gt; string.
  `:format-error-fn` - (fn [error])    =&gt; string.</pre></div></div><div class="public anchor" id="var-signal-preamble-fn"><h3>signal-preamble-fn</h3><h4 class="lang"><a href="taoensso.telemere.utils.html#var-signal-preamble-fn">clj</a></h4><h4 class="lang current">cljs</h4><div class="usage"><code>(signal-preamble-fn)</code><code>(signal-preamble-fn {:keys [format-inst-fn], :or {format-inst-fn (format-inst-fn)}})</code></div><div class="doc"><pre class="plaintext">Experimental, subject to change.
Returns a (fn preamble [signal]) that:
  - Takes a Telemere signal (map).
  - Returns a signal preamble ?string like:
    "2024-03-26T11:14:51.806Z INFO EVENT Hostname taoensso.telemere(2,21) ::ev-id - msg"

Options:
  `:format-inst-fn` - (fn format [instant]) =&gt; string.</pre></div></div></div></body></html>